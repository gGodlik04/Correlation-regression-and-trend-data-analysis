import numpy as np
import matplotlib.pyplot as plt

# Заданные данные
x_data = np.array([
    12.220955, 14.501879, 11.235762, 12.988893, 12.432949, 9.672868,
    10.055631, 13.564067, 12.387528, 14.194248, 10.230523, 14.883280,
    12.011416, 11.801776, 10.857422, 12.769585, 12.877913, 12.191227,
    14.400637, 13.101295, 9.697588, 12.598446, 14.669744, 13.347720,
    9.666343, 11.975549, 11.258987, 11.343169, 12.592716, 12.595488,
    10.521761, 10.130285, 13.340697, 12.319422, 11.921422, 11.923549,
    13.651659, 13.167367, 11.665363, 12.056086, 12.612326, 12.885751,
    13.685364, 13.856971, 12.146988, 12.364146, 10.302603, 11.153591,
    9.784530, 11.440074, 9.610131, 13.180910, 11.982354, 12.587590,
    13.029359, 10.154689, 13.335695, 13.693765, 11.199297, 14.715755,
    14.198775, 10.381113, 12.008401, 13.396364, 11.879134, 9.370118,
    10.556769, 12.962738, 10.269789, 11.804204, 12.149156, 11.762865,
    11.903238, 10.205228, 12.621951, 12.552223, 11.979987, 13.523686,
    11.522578, 13.132822, 13.312578, 10.994646, 13.524868, 10.283075,
    10.780084, 11.367182, 15.556915, 13.569090, 9.933348, 13.531510,
    9.769963, 12.589641, 10.678101, 10.957990, 12.114030, 9.457369,
    13.237444, 11.011844, 14.828538, 11.110905
])

y_data = np.array([
    25.62161, 30.85004, 24.93063, 26.02518, 24.87211, 22.10477,
    21.72389, 29.98874, 25.84005, 30.32742, 22.67426, 31.81680,
    26.19805, 25.60587, 22.31550, 28.35173, 26.67087, 25.66100,
    29.25990, 26.99284, 22.14053, 27.07693, 30.75009, 28.21115,
    20.28154, 26.48862, 24.26549, 23.84879, 26.50028, 27.39787,
    21.90163, 22.24278, 29.55267, 25.47545, 25.65284, 26.65707,
    29.16964, 28.00093, 24.72309, 26.14017, 25.25142, 26.91081,
    28.95006, 28.57193, 27.01750, 25.81725, 22.50013, 24.95787,
    19.94332, 23.70989, 21.11818, 29.22508, 26.81836, 27.85386,
    26.08376, 20.62868, 29.46731, 29.26553, 24.40003, 30.59607,
    28.51505, 23.48660, 24.73207, 29.07854, 23.88507, 20.74531,
    21.79120, 27.15660, 20.70397, 23.65151, 25.81716, 25.68416,
    24.62132, 23.00292, 28.05434, 26.77368, 25.35128, 28.07289,
    25.08780, 28.27231, 29.46238, 22.94998, 28.99154, 22.59557,
    22.64686, 23.77769, 31.31091, 28.77265, 20.08582, 27.07522,
    21.56407, 27.58080, 22.04215, 22.78225, 26.54297, 18.93037,
    29.02508, 24.54163, 32.46110, 22.29833
])

# Создание линейной модели методом наименьших квадратов
A = np.vstack([x_data, np.ones(len(x_data))]).T
m, c = np.linalg.lstsq(A, y_data, rcond=None)[0]

# Генерация значений для линии регрессии
x_reg = np.linspace(min(x_data), max(x_data), 100)
y_reg = m * x_reg + c

# Построение графика
plt.figure(figsize=(10, 6))
plt.scatter(x_data, y_data, label='Точки')
plt.plot(x_reg, y_reg, color='red', label='Линейная регрессия')
for x, y in zip(x_data, y_data):
    plt.plot([x, x], [y, m * x + c], color='gray', linestyle='--')
plt.xlabel('X')
plt.ylabel('Y')
plt.title('Линейная регрессия методом наименьших квадратов')
plt.legend()
plt.grid(True)
plt.show()